package fes.aragon.modelo;

import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.util.ArrayList;

import javax.swing.JOptionPane;
import javax.swing.table.AbstractTableModel;

import com.sun.webkit.ContextMenu.ShowContext;

import fes.aragon.clases.Racional;

public class ModeloTabla extends AbstractTableModel implements
		PropertyChangeListener {

	private Dato dato = new Dato();
	private Racional racional = new Racional();

	public int getColumnCount() {
		// TODO Auto-generated method stub
		return dato.getDatos()[0].length;
	}

	public int getRowCount() {
		// TODO Auto-generated method stub
		return dato.getDatos().length;
	}

	public Object getValueAt(int arg0, int arg1) {
		// TODO Auto-generated method stub
		return dato.getDatos()[arg0][arg1];
	}

	@Override
	public String getColumnName(int column) {
		// TODO Auto-generated method stub
		return dato.getNombres()[column];
	}

	@Override
	public boolean isCellEditable(int rowIndex, int columnIndex) {
		// TODO Auto-generated method stub
		boolean editar = true;
		if (columnIndex == 2) {
			editar = false;
		}
		return editar;
	}

	@Override
	public void setValueAt(Object aValue, int rowIndex, int columnIndex) {
		// TODO Auto-generated method stub
		String c = (String) aValue;
		Racional info = new Racional();
		System.out.println(c);
		String[] arg = c.split("/");
		if (arg.length > 0) {
				int a = Integer.parseInt(arg[0]);
				int b = Integer.parseInt(arg[1]);
				// int den = Integer.parseInt(arg[1]);
				// Racional rsc = new Racional(num, den);
				// System.out.println(rsc);
				
				racional.setNumerador(a);
				racional.setDenominador(b);
			
			// dato.getDatos()[rowIndex][columnIndex] = (Racional) info;
			// dato.getDatos()[rowIndex][columnIndex] = (Racional) info;
			dato.getDatos()[rowIndex][columnIndex] = racional;
		} else {
			JOptionPane.showMessageDialog(null, "Error en la entrada de datos");

		}
	} 

	public void propertyChange(PropertyChangeEvent evt) {
		// TODO Auto-generated method stub
		if (evt.getPropertyName().equals("modifica.matriz")) {
			this.dato = (Dato) evt.getNewValue();
			//for(int i = 0;i<dato.getDatos().length; i++){
				//this.racional.add(dato.getDatos()[i]);
			//}
			System.out.println("evento");
			this.fireTableDataChanged();
		}

	}

	public void oyenteDato(Datos dato) {
		dato.setMatriz(this.dato.getDatos());
	}

}
